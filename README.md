forked from https://techcraft.codeplex.com/